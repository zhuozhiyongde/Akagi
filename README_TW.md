<div align="center">
  <img src="https://github.com/shinkuan/RandomStuff/assets/35415788/db94b436-c3d4-4c57-893e-8db2074d2d22" width="50%">
  <h1 align="center">Akagi</h1>

  <div align="center">
  ã€Œæ­»ã­ã°åŠ©ã‹ã‚‹ã®ã«â€¦â€¦â€¦ã€- èµ¤æœ¨ã—ã’ã‚‹<br>
  <div align="center">
  <a href="./README.md">English</a> | <a href="./README_ZH.md">ç®€ä½“ä¸­æ–‡</a>
  <br/>
  <a href="https://github.com/shinkuan/Akagi/issues">å›å ±éŒ¯èª¤</a> | <a href="https://github.com/shinkuan/Akagi/issues">åŠŸèƒ½è«‹æ±‚</a> | 
  <a href="https://discord.gg/Z2wjXUK8bN">æœ‰å•é¡Œè«‹è‡³ Discord è©¢å•</a>
  <br/>
  <br/>
  </div>
  </div>
</div>

<div align="center">
  <a href="https://github.com/shinkuan/Akagi"><img src="https://img.shields.io/github/stars/shinkuan/Akagi?logo=github" alt="GitHub stars" /></a>
  <a href="https://github.com/shinkuan/Akagi/releases"><img src="https://img.shields.io/github/v/release/shinkuan/Akagi?label=release&logo=github" alt="GitHub release" /></a>
  <a href="https://github.com/shinkuan/Akagi/issues"><img src="https://img.shields.io/github/issues/shinkuan/Akagi?logo=github" alt="GitHub issues" /></a>
  <a href="https://github.com/shinkuan/Akagi"><img src="https://img.shields.io/github/languages/top/shinkuan/Akagi?logo=python" alt="Top language" /></a>
  <a href="https://discord.gg/Z2wjXUK8bN"><img src="https://img.shields.io/discord/1192792431364673577?label=discord&logo=discord&color=7289DA" alt="Discord" /></a>
  <a href="https://deepwiki.com/shinkuan/Akagi"><img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki"></a>
</div>

## é—œæ–¼

> [!CAUTION]
>
> æœ¬å°ˆæ¡ˆæ—¨åœ¨æä¾›ä¸€å€‹ä¾¿åˆ©çš„æ–¹å¼ï¼Œè®“ç©å®¶å¯ä»¥å³æ™‚äº†è§£è‡ªå·±åœ¨éº»å°‡å°å±€ä¸­çš„è¡¨ç¾ï¼Œä¸¦è—‰æ­¤å­¸ç¿’èˆ‡é€²æ­¥ã€‚æ­¤å°ˆæ¡ˆåƒ…ä¾›æ•™è‚²ç”¨é€”ï¼Œä½œè€…ä¸å°ä½¿ç”¨è€…åˆ©ç”¨æ­¤å°ˆæ¡ˆæ¡å–çš„ä»»ä½•è¡Œç‚ºè² è²¬ã€‚è‹¥ä½¿ç”¨è€…é•åéŠæˆ²æœå‹™æ¢æ¬¾ï¼ŒéŠæˆ²é–‹ç™¼è€…èˆ‡ç™¼è¡Œå•†æœ‰æ¬Šé€²è¡Œè™•ç½®ï¼ŒåŒ…å«å¸³è™Ÿåœæ¬Šç­‰å¾Œæœï¼Œèˆ‡ä½œè€…ç„¡é—œã€‚

![image](./docs/images/example_majsoul.png)

## åŠŸèƒ½

-   å³æ™‚é¡¯ç¤ºå°å±€è³‡è¨Š
-   å³æ™‚é¡¯ç¤º AI è©•ä¼°
-   æ”¯æ´é›€é­‚ã€å¤©é³³ã€éº»é›€ä¸€ç•ªè¡—ã€å¤©æœˆ
-   æ”¯æ´å››äººéº»å°‡èˆ‡ä¸‰äººéº»å°‡
-   å¯ä½¿ç”¨å¤šç¨® AI æ¨¡å‹
    -   å…§å»ºæ¨¡å‹
    -   ç·šä¸Šä¼ºæœå™¨æ¨¡å‹
    -   è‡ªè£½æ¨¡å‹
-   è‡ªå‹•åŒ–å°å±€ï¼ˆåƒ…é™ Windows Release ç‰ˆä¸¦å•Ÿç”¨ç·šä¸Šä¼ºæœå™¨æ¨¡å‹æ™‚å¯ç”¨ï¼‰
-   TUI ä»‹é¢ï¼Œæ”¯æ´å¤šç¨®ä¸»é¡Œ

## ç›®éŒ„

> [!WARNING]
>
> é–‹å§‹ä½¿ç”¨å‰è«‹ä»”ç´°é–±è®€

-   [é—œæ–¼](#é—œæ–¼)
-   [åŠŸèƒ½](#åŠŸèƒ½)
-   [é–‹å§‹å‰](#é–‹å§‹å‰)
    -   [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
    -   [æ”¯æ´ç‹€æ³](#æ”¯æ´ç‹€æ³)
-   [å®‰è£](#å®‰è£)
    -   [ä¸€èˆ¬ä½¿ç”¨è€…](#ä¸€èˆ¬ä½¿ç”¨è€…)
    -   [é–‹ç™¼è€…](#é–‹ç™¼è€…)

## é–‹å§‹å‰

[ğŸ¥ æ•™å­¸å½±ç‰‡](https://youtu.be/Z88Ncxbe2nw)

### å‰ç½®è¦æ±‚

ç‚ºäº†ä½¿ç”¨æœ¬å°ˆæ¡ˆï¼Œä½ éœ€è¦æº–å‚™ï¼š

1. ä¸€å€‹ `mjai_bot`
    1. å°ˆæ¡ˆå…§å·²å…§å»ºä¸€å€‹å¯ç”¨çš„ `mortal` mjai botï¼Œä½æ–¼ [é€™è£¡](./mjai_bot/mortal)
        - ç”±æ–¼å€‰åº«å¤§å°é™åˆ¶ï¼Œ`./mjai_bot/mortal` ä¸‹çš„ `mortal.pth` æ˜¯ç¸®å°ç‰ˆæ¨¡å‹
        - ä¸å»ºè­°åœ¨å¯¦æˆ°ä¸­ä½¿ç”¨
        - è‹¥æƒ³å–å¾—å…¶ä»–æ¨¡å‹ï¼Œå¯ä»¥å¾ [Discord](https://discord.gg/Z2wjXUK8bN) å–å¾—ï¼Œè£¡é¢æä¾›ç›¸ç•¶æ–¼é›€é­‚é›€è±ªæ®µä½çš„ Mortal V4 æ¨¡å‹ï¼ˆ~100MBï¼‰ï¼Œä½†ä½ å¯èƒ½éœ€è¦å¾®èª¿å…¶ç¨‹å¼ç¢¼ä»¥é©é…æœ¬æ¡†æ¶ã€‚
        - è‹¥æƒ³å–ç”¨æ›´å¼·çš„ AI æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç·šä¸Šä¼ºæœå™¨æ¶è¨­çš„æ¨¡å‹ï¼ˆå³ `ot_server`ï¼‰ï¼Œé€™éœ€è¦å¾ [Discord](https://discord.gg/Z2wjXUK8bN) å–å¾— API é‡‘é‘°ï¼Œå…¶æ°´å¹³ç›¸ç•¶æ–¼é›€é­‚é­‚å¤©æ®µä½ã€‚
    2. æˆ–è‡ªè¡Œè£½ä½œï¼Œè«‹åƒé–± [é–‹ç™¼è€…](#é–‹ç™¼è€…)
2. ä½¿ç”¨ Windows Terminalï¼ˆWindowsï¼‰/ Terminalï¼ˆmacOSï¼‰å•Ÿå‹• Akagi æ‰èƒ½çœ‹åˆ°æ¼‚äº®çš„ TUIã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¨­å®šä¸­åœç”¨ TUIï¼Œæ”¹ç‚ºå•Ÿç”¨ DataServer é€²è¡Œå‰å¾Œç«¯åˆ†é›¢ï¼Œæ­é… [AkagiFrontend](https://github.com/zhuozhiyongde/AkagiFrontend) é¡¯ç¤ºå°å±€è³‡è¨Šã€‚é€™å…è¨±ä½ ä½¿ç”¨ PiP æ–¹å¼å³æ™‚æŸ¥çœ‹æç¤ºï¼Œä¸¦åœ¨ iOS / iPadOS ç­‰è¡Œå‹•è£ç½®ä¸Šä½¿ç”¨ï¼Œå…·é«”éƒ¨ç½²æ–¹æ³•è«‹è¦‹å¾Œæ–‡ [ä½¿ç”¨æ–¹å¼](#ä½¿ç”¨æ–¹å¼)ã€‚
3. ä½¿ç”¨ [Clash Party](https://github.com/mihomo-party-org/clash-party) / [Clash Verge Rev](https://github.com/clash-verge-rev/clash-verge-rev) / [Surge](https://nssurge.com/) ç­‰ä»£ç†å·¥å…·å°‡éŠæˆ²æµé‡å°å‘ MitM é€£æ¥åŸ ï¼Œå…·é«”åˆ†æµè¦å‰‡è«‹åƒé–±å¾Œæ–‡ [ä½¿ç”¨æ–¹å¼](#ä½¿ç”¨æ–¹å¼)ã€‚

### æ”¯æ´ç‹€æ³

ç›®å‰å°å„ç«‹ç›´éº»å°‡å¹³å°çš„æ”¯æ´ç‹€æ³å¦‚ä¸‹ï¼š

| å¹³å°           | å››äººéº»å°‡ | ä¸‰äººéº»å°‡ | è‡ªå‹•æ‰“ç‰Œ  |
| -------------- | -------- | -------- | --------- |
| **é›€é­‚**       | &check;  | &check;  | \*&check; |
| **å¤©é³³**       | &check;  | &check;  | &cross;   |
| **éº»é›€ä¸€ç•ªè¡—** | &check;  | &check;  | \*&check; |
| **å¤©æœˆ**       | &check;  | &check;  | \*&check; |

è¨»ï¼šè‡ªå‹•æ‰“ç‰Œåƒ…æ”¯æ´ [Windows Release ç‰ˆ](https://github.com/shinkuan/Akagi/releases)ï¼Œä¸”å¿…é ˆå•Ÿç”¨ `ot_server`ã€‚

## å®‰è£

### ä¸€èˆ¬ä½¿ç”¨è€…

Windows ä½¿ç”¨è€…å¯ç›´æ¥åˆ° [release é é¢](https://github.com/shinkuan/Akagi/releases) ä¸‹è¼‰æœ€æ–°ç‰ˆï¼Œè§£å£“ç¸®å¾Œï¼Œå°‡ mjai bot æ”¾åˆ° `./Akagi/mjai_bot` ç›®éŒ„ä¸‹ï¼Œç„¶å¾ŒåŸ·è¡Œ `run_akagi.exe` å³å¯ã€‚

### é–‹ç™¼è€…

å°æ–¼é–‹ç™¼è€…ï¼ˆæˆ– macOS ç­‰å…¶ä»–å¹³å°çš„ä½¿ç”¨è€…ï¼‰ï¼Œå¯ä»¥ clone æœ¬å°ˆæ¡ˆï¼Œä½¿ç”¨ Python 3.12 å®‰è£ä¾è³´ï¼Œå°‡ mjai bot æ”¾åˆ° `./Akagi/mjai_bot` ç›®éŒ„ä¸‹ï¼Œä¾å¹³å°é¸æ“‡åˆé©çš„ libriichi å‡½å¼åº«æª”æ¡ˆï¼Œæœ€å¾ŒåŸ·è¡Œ `run_akagi.py`ã€‚

```bash
git clone https://github.com/shinkuan/Akagi.git
cd Akagi
pip install -r requirements.txt
# å°æ–¼ä¸­åœ‹å¢ƒå…§ä½¿ç”¨è€…ï¼Œä½ ä¹Ÿå¯ä»¥é¸æ“‡ä½¿ç”¨æ¸…è¯æºä¾†åŠ é€Ÿä¾è³´å®‰è£ï¼š
# pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt
mv ./mjai_bot/mortal/libriichi/libriichi-<version>-<platform>.<extension> ./mjai_bot/mortal/libriichi.<extension>
python run_akagi.py
```

é—œæ–¼æ›´å¤š libriichi å‡½å¼åº«æª”æ¡ˆçš„é¸æ“‡ï¼š

-   å°æ–¼ macOSï¼š
    -   M ç³»åˆ—æ™¶ç‰‡ï¼š`libriichi-*-aarch64-apple-darwin.so`
    -   Intel æ™¶ç‰‡ï¼š`libriichi-*-x86_64-apple-darwin.so`
-   å°æ–¼ Windowsï¼š`libriichi-*-x86_64-pc-windows-msvc.pyd`
-   å°æ–¼ Linuxï¼š`libriichi-*-x86_64-unknown-linux-gnu.so`

æ³¨æ„ï¼Œå…¶ä¸­çš„ `*` éœ€è¦ä¾ä½ çš„ Python ç‰ˆæœ¬é€²è¡Œé¸æ“‡ã€‚ç›®å‰æä¾› Python 3.10/3.11/3.12 çš„ç‰ˆæœ¬ï¼Œä½†æœ¬å°ˆæ¡ˆé è¨­æ¨è–¦ä½¿ç”¨ Python 3.12ï¼›å¦‚æœä½ åœ¨å…¶ä»–ç‰ˆæœ¬é‡åˆ°å•é¡Œï¼Œè«‹å˜—è©¦æ”¹ç”¨ Python 3.12ã€‚

è‹¥éœ€æ›´å¤šè³‡è¨Šæˆ–åŸå§‹ç¢¼ï¼Œå¯åƒè€ƒ [Mortal](https://github.com/Equim-chan/Mortal) å°ˆæ¡ˆã€‚

## ä½¿ç”¨æ–¹å¼

è¦ä½¿ç”¨ Akagiï¼Œéœ€è¦åšä¸å°‘æº–å‚™ï¼Œè«‹ä»”ç´°é–±è®€ä¸‹æ–‡ã€‚

### æª¢æŸ¥è¨­å®šèˆ‡ AI æ¨¡å‹

1. é¸æ“‡æ¨¡å‹
    - é»é¸å·¦ä¸‹è§’çš„ `Model` æŒ‰éˆ•
    - å¾æ¸…å–®ä¸­é¸æ“‡ä¸€å€‹æ¨¡å‹
    - è‹¥æ²’æœ‰æ¨¡å‹ï¼Œå¯å¾ [Discord](https://discord.gg/Z2wjXUK8bN) å–å¾—
    - å…§å»ºé è¨­æ¨¡å‹ç‚ºå¼± AI
    - **3 äººå°å±€è«‹é¸ 3P æ¨¡å‹ï¼**
    - **ä¸è¦ç”¨ 4P æ¨¡å‹åƒèˆ‡ 3 äººå°å±€ï¼**
2. æª¢æŸ¥è¨­å®š
    - é»é¸å·¦ä¸‹è§’çš„ `Settings` æŒ‰éˆ•
    - ç¢ºèªè¨­å®šæ˜¯å¦æ­£ç¢º
    - å°‡ MitM é¡å‹è¨­å®šç‚ºä½ æ­£åœ¨ç©çš„éŠæˆ²
    - è¨­å®šæ­£ç¢ºçš„ MitM Host èˆ‡ Port
    - è‹¥ä¸æ¸…æ¥šï¼Œè«‹ä¿ç•™é è¨­å€¼
    - é è¨­å€¼ï¼š`host: 127.0.0.1, port: 7880`
    - è‹¥ä½ æœ‰å–å¾—ç·šä¸Šä¼ºæœå™¨ API é‡‘é‘°ï¼ˆç·šä¸Šä¼ºæœå™¨æä¾›æ›´å¼·çš„ AI æ¨¡å‹ï¼Œæ°´å¹³ç›¸ç•¶æ–¼é›€é­‚é­‚å¤©æ®µä½ï¼‰ï¼Œè«‹åœ¨è¨­å®šä¸­è¼¸å…¥ï¼›è‹¥æ²’æœ‰ï¼Œå¯ä»¥å¾ [Discord](https://discord.gg/Z2wjXUK8bN) å–å¾—ã€‚
3. å„²å­˜è¨­å®š
    - é»é¸ `Save` æŒ‰éˆ•
    - å°‡è¨­å®šå„²å­˜ä¸‹ä¾†
4. é‡æ–°å•Ÿå‹• Akagi
    - é—œé–‰ Akagi ä¸¦é‡æ–°é–‹å•Ÿ
    - é‡æ–°å•Ÿå‹•å¾Œè¨­å®šæ‰æœƒå¥—ç”¨
5. å•Ÿå‹• MitM
    - é»é¸å·¦ä¸‹è§’çš„ `MitM Stopped` æŒ‰éˆ•
    - é€™æœƒå•Ÿå‹• MitM ä»£ç†ä¼ºæœå™¨

### å®‰è£ä¸¦ä¿¡ä»» MitM Proxy æ†‘è­‰

#### Windows ä½¿ç”¨è€…

1. é–‹å•Ÿæª”æ¡ˆç¸½ç®¡ï¼ˆæŒ‰ä¸‹ `Windows éµ + E`ï¼‰
2. åœ¨ä¸Šæ–¹åœ°å€åˆ—è¼¸å…¥ `%USERPROFILE%\.mitmproxy`ï¼ˆmitmproxy çš„é»˜èªæ†‘è­‰å„²å­˜è·¯å¾‘ï¼‰å¾ŒæŒ‰ Enter
3. æ‰¾åˆ°åç‚º `mitmproxy-ca-cert.cer` çš„æ†‘è­‰æª”
4. é›™æ“Šè©²æ†‘è­‰æª”
5. é»é¸ `å®‰è£æ†‘è­‰` æŒ‰éˆ•
6. è‹¥å‡ºç¾é¸é …ï¼Œè«‹é¸ `æœ¬æ©Ÿé›»è…¦`ï¼Œç„¶å¾Œé»é¸ä¸‹ä¸€æ­¥
7. é¸æ“‡ `å°‡æ‰€æœ‰æ†‘è­‰æ”¾å…¥ä¸‹åˆ—å­˜æ”¾å€`ï¼Œç„¶å¾Œé» `ç€è¦½...`
8. é¸æ“‡ `å—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½`ï¼ŒæŒ‰ä¸‹ç¢ºå®šï¼Œå†é»é¸ä¸‹ä¸€æ­¥èˆ‡å®Œæˆ
9. è‹¥ç³»çµ±è¦æ±‚æ¬Šé™ï¼Œè«‹é»é¸æ˜¯

#### macOS ä½¿ç”¨è€…

1. æ‰“é–‹ Finder
2. æŒ‰ä¸‹ `Command + Shift + G` æ‰“é–‹ã€Œå‰å¾€è³‡æ–™å¤¾ã€å°è©±æ¡†ï¼Œè¼¸å…¥ `~/.mitmproxy` å¾ŒæŒ‰ Enter
3. æ‰¾åˆ°åç‚º `mitmproxy-ca-cert.cer` çš„æ†‘è­‰æª”
4. é›™æ“Šè©²æ†‘è­‰æª”ï¼Œé€²å…¥ã€Œé‘°åŒ™åœˆå­˜å–ã€
5. é»é¸å·¦é‚Š `ç³»çµ±é‘°åŒ™åœˆ` ä¸‹çš„ `ç³»çµ±` åˆ†é ï¼Œå³ä¸Šè§’æœå°‹ `mitmproxy`ï¼Œæ‰¾åˆ°åŒ¯å…¥çš„æ†‘è­‰ï¼Œæ­¤æ™‚æ˜¯æœªä¿¡ä»»ç‹€æ…‹
6. å³éµåç‚º `mitmproxy` çš„æ†‘è­‰é …ï¼Œé¸æ“‡ `é¡¯ç¤ºç°¡ä»‹`ï¼Œåœ¨è·³å‡ºçš„è¦–çª—ä¸­å±•é–‹ `ä¿¡ä»»`
7. å°‡ `ä½¿ç”¨æ­¤æ†‘è­‰æ™‚` æ”¹ç‚º `æ°¸é ä¿¡ä»»`
8. é—œé–‰è¦–çª—ï¼Œæ–¼å½ˆå‡ºçš„èªè­‰æ¡†ä¸­å®Œæˆèªè­‰å³å¯

#### iOS / iPadOS ä½¿ç”¨è€…

è‹¥ä½ é€éå‰å¾Œç«¯åˆ†é›¢éƒ¨ç½²å°‡æœ¬å°ˆæ¡ˆç•¶ä½œä»£ç†ç¯€é»ï¼Œä¹Ÿèƒ½åœ¨ iOS / iPadOS ä¸Šä½¿ç”¨ï¼Œä½†ä»éœ€åœ¨è©²è£ç½®ä¸Šå®Œæˆæ†‘è­‰ä¿¡ä»»ã€‚

1. å…ˆå°‡é›»è…¦ä¸Šçš„ `mitmproxy-ca-cert.cer` æ†‘è­‰é€é AirDrop æˆ–å…¶ä»–æ–¹å¼å‚³é€åˆ° iPhone/iPadï¼Œæœ€å¥½ä½¿ç”¨ AirDrop å¯è‡ªå‹•å®ŒæˆåŒ¯å…¥ã€‚å…¶ä»–æ–¹å¼éœ€å…ˆä¿å­˜åˆ°æª”æ¡ˆï¼Œå†å¾æª”æ¡ˆä¸­é»é–‹è©²æ†‘è­‰ã€‚
2. é€²å…¥ `è¨­å®š > å·²ä¸‹è¼‰æè¿°æª”`ï¼Œé»æ“Šå®‰è£
3. å‰å¾€ `ä¸€èˆ¬ > é—œæ–¼æœ¬æ©Ÿ > æ†‘è­‰ä¿¡ä»»è¨­å®š`ï¼Œé–‹å•Ÿ mitmproxy çš„é¸é …

#### Android ä½¿ç”¨è€…

ç¼ºä¹æ¸¬è©¦ç’°å¢ƒï¼Œè«‹è‡ªè¡ŒæŸ¥æ‰¾ç›¸é—œæ“ä½œã€‚

### ä»£ç†è»Ÿé«”åˆ†æµ

Akagi é è¨­åœ¨æœ¬åœ° `127.0.0.1:7880` å•Ÿå‹•ä¸€å€‹ HTTPS ä»£ç†ï¼ˆåŸºæ–¼ mitmproxyï¼‰ã€‚æ¨è–¦ä½¿ç”¨æ”¯æ´è¦å‰‡åˆ†æµèˆ‡è¦†å¯«çš„ä»£ç†è»Ÿé«”ï¼ˆå¦‚ `Mihomo` ç³»çš„ `Clash Party` æˆ– `Clash Verge` / `Surge`ï¼‰ï¼Œå°‡é›€é­‚ç›¸é—œæµé‡å°å‘è©²é€£æ¥åŸ ï¼Œä¸¦ä»¥å›é¿è¦å‰‡è®“ Python è¡Œç¨‹ç›´é€£ä»¥é¿å…å›ç’°ã€‚

> [!NOTE]
>
> è‹¥ä½ æƒ³èˆ‡ [MajsoulMax](https://github.com/Avenshy/MajsoulMax) æˆ– [MajsoulMax-rs](https://github.com/Xerxes-2/MajsoulMax-rs) è¯å‹•ï¼Œéœ€è¦æ­å»ºä¸²è¯ä»£ç†éˆï¼Œè©³è¦‹å¾Œæ–‡é€²éšä½¿ç”¨éƒ¨åˆ†ã€‚

ä»¥æœ¬åœ°ç¯€é» `Akagi`ï¼ˆHTTPS 127.0.0.1:7880ï¼‰ç‚ºä¾‹ï¼Œè¦å‰‡ä¸­éœ€è¦è®“ Python è¡Œç¨‹ç›´é€£ï¼Œå†æŠŠéŠæˆ² / ç¶²é æµé‡åˆ†æµåˆ°è©²ç¯€é»ï¼Œå½¢æˆ `Game <-> Akagi <-> Server` çš„é›™å‘ä»£ç†éˆã€‚

#### Clash Party / Clash Verge è¨­å®šç¯„ä¾‹

```yml
proxies:
    - name: Akagi
      type: http
      server: 127.0.0.1
      port: 7880
      tls: true

proxy-groups:
    - name: ğŸ€„ é›€é­‚éº»å°‡
      type: select
      proxies:
          - Akagi
          - DIRECT

rules:
    # é¿å…å›ç’°
    - AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
    # å®¢æˆ¶ç«¯ / Steam
    - PROCESS-NAME,Jantama_MahjongSoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,jantama_mahjongsoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
    # ç¶²é ç‰ˆ
    - DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

#### Surge è¨­å®šç¯„ä¾‹

```text
[Proxy]
Akagi = https, 127.0.0.1, 7880

[Proxy Group]
ğŸ€„ é›€é­‚éº»å°‡ = select, Akagi, DIRECT

[Rule]
# é¿å…å›ç’°ä»£ç†
AND, ((PROCESS-NAME, python*), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
# å®¢æˆ¶ç«¯ / Steam
PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
# ç¶²é ç‰ˆ
DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

#### Clash Verge å…¨åŸŸæ“´å±•è…³æœ¬ï¼ˆJSï¼‰ç¯„ä¾‹

åƒè€ƒ [å®˜æ–¹æ–‡ä»¶](https://www.clashverge.dev/guide/script.html)ï¼Œå¯æŒ‰ä¸‹åˆ—æ–¹å¼è¨­å®šã€‚

åœ¨ã€Œè¨‚é–±ã€é é¢å³éµ `å…¨åŸŸæ“´å±•è…³æœ¬`ï¼Œé¸æ“‡ã€Œç·¨è¼¯æª”æ¡ˆã€ï¼š

```js
function main(config) {
    config.proxies.push({
        name: 'Akagi',
        type: 'http',
        server: '127.0.0.1',
        port: 7880,
        tls: true,
    });

    config['proxy-groups'].push({
        name: 'ğŸ€„ é›€é­‚éº»å°‡',
        type: 'select',
        proxies: ['DIRECT', 'Akagi'],
        icon: 'https://www.maj-soul.com/homepage/img/logotaiwan.png',
    });

    const bypass = [
        'AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT',
    ];

    const clientRules = [
        'PROCESS-NAME,Jantama_MahjongSoul.exe,ğŸ€„ é›€é­‚éº»å°‡',
        'PROCESS-NAME,jantama_mahjongsoul.exe,ğŸ€„ é›€é­‚éº»å°‡',
        'PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡',
    ];

    const webRules = [
        'DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡',
        'DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡',
        'DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡',
        'DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡',
        'DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡',
    ];

    config.rules.unshift(...bypass, ...clientRules, ...webRules);
    return config;
}
```

#### Clash Partyï¼ˆåŸ Mihomo Partyï¼‰è¦†å¯« YAML ç¯„ä¾‹

åƒè€ƒ [å®˜æ–¹æ–‡ä»¶](https://clashparty.org/docs/guide/override/yaml)ï¼Œå¯æŒ‰ç…§ä¸‹åˆ—æ–¹å¼è¨­å®šã€‚

åœ¨ Clash Party å·¦å´ã€Œè¦†å¯«ã€é é¢é»é¸ `+`ï¼Œé¸æ“‡ã€Œæ–°å»º YAMLã€ï¼Œç„¶å¾Œè¤‡è£½ä»¥ä¸‹å…§å®¹ï¼Œé»é¸ã€Œç¢ºèªã€å„²å­˜ï¼Œå†é»æ“Šå°æ‡‰è¦†å¯«å¡ç‰‡å³ä¸Šè§’çš„ `...`ï¼Œé¸æ“‡ã€Œç·¨è¼¯è³‡è¨Šã€-ã€Œå…¨åŸŸå•Ÿç”¨ã€ã€‚

```yml
# https://mihomo.party/docs/guide/override/yaml
+proxies:
    - name: Akagi
      type: http
      server: 127.0.0.1
      port: 7880
      tls: true
+proxy-groups:
    - name: ğŸ€„ é›€é­‚éº»å°‡
      proxies:
          - Akagi
          - DIRECT
      type: select
+rules:
    - AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
    - PROCESS-NAME,Jantama_MahjongSoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,jantama_mahjongsoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

### å•Ÿå‹•å°å±€

å®Œæˆä¸Šè¿°æµç¨‹å¾Œï¼Œæ‡‰å¯æ­£å¸¸é€²è¡ŒéŠæˆ²ä¸¦ç²å¾— AI åˆ†æã€‚å»ºè­°å…ˆåœ¨äººæ©Ÿå°æˆ°ä¸­æ¸¬è©¦æ˜¯å¦é‹ä½œæ­£å¸¸ã€‚

è‹¥é‡åˆ°å•é¡Œï¼Œè«‹å…ˆæª¢æŸ¥ Akagi ç›®éŒ„ä¸‹ `logs` ç›®éŒ„çš„æ—¥èªŒä»¥æ’é™¤éŒ¯èª¤ï¼›è‹¥ä»ç„¡æ³•è§£æ±ºï¼Œå¯è‡³ [Discord](https://discord.gg/Z2wjXUK8bN) æ±‚åŠ©æˆ–åœ¨ Issue ä¸­æå•ã€‚

## é€²éšä½¿ç”¨

### DataServer

DataServer æ˜¯ Akagi æ–°å¢çš„å¯é¸åŠŸèƒ½ï¼Œé è¨­å•Ÿç”¨ã€‚å®ƒå¯ä»¥ä½œç‚º SSEï¼ˆServer Sent Eventsï¼‰ä¼ºæœå™¨ï¼Œå°‡ AI åˆ†æçµæœå³æ™‚æ¨é€çµ¦å‰ç«¯é é¢ã€‚è‹¥è¦åœ¨ iOS / iPadOS ç­‰è¡Œå‹•ç«¯ä½¿ç”¨å¾Œç«¯éƒ¨ç½²æ¨¡å¼ï¼Œå¿…é ˆé–‹å•Ÿæ­¤åŠŸèƒ½ã€‚

è¦é–‹å•Ÿ DataServerï¼Œå¯åœ¨è¨­å®šä¸­ï¼ˆé€é TUI æˆ–ä¿®æ”¹ `settings/settings.json` çš„ `dataserver` æ¬„ä½ç‚º `true`ï¼‰å•Ÿç”¨ï¼Œç„¶å¾Œé‡æ–°å•Ÿå‹• Akagiã€‚

å•Ÿå‹• DataServer å¾Œï¼ŒAkagi æœƒåœ¨ `0.0.0.0:8765` å•Ÿå‹• SSE ä¼ºæœå™¨ï¼Œä¹‹å¾Œå¯ä½¿ç”¨ [AkagiFrontend](https://github.com/zhuozhiyongde/AkagiFrontend) ä½œç‚ºå‰ç«¯å±•ç¤ºï¼Œå¯¦ç¾å‰å¾Œç«¯åˆ†é›¢ï¼Œä¸¦ä½¿ç”¨ PiPï¼ˆç•«ä¸­ç•«ï¼‰å–ä»£ TUI é¡¯ç¤ºçµæœã€‚å°é›»è…¦ç«¯ä¾†èªªé€™ä¸æ˜¯å¿…é ˆï¼Œä½†å°è¡Œå‹•ç«¯å‰‡æ˜¯å”¯ä¸€æ–¹å¼ã€‚

è‹¥ä½ æƒ³åœ¨ VPS ä¸Šå°‡ Akagi å®Œå…¨ä½œç‚ºå¾Œç«¯æœå‹™éƒ¨ç½²ï¼Œä¸¦åœç”¨ TUIï¼Œä¹Ÿå¯ä»¥åœ¨è¨­å®šä¸­ï¼ˆé€é TUI æˆ–ä¿®æ”¹ `settings/settings.json` çš„ `tui` æ¬„ä½ç‚º `false`ï¼‰é—œé–‰ TUIï¼Œç„¶å¾Œé‡æ–°å•Ÿå‹• Akagiã€‚æ­¤æ™‚åªèƒ½é€é DataServer çš„ SSE æœå‹™åŸ å–å¾—çµæœã€‚

è‹¥åŒæ™‚åœç”¨ DataServer èˆ‡ TUIï¼Œå°±ç„¡æ³•å–å¾—æ¨¡å‹æ¨ç†çµæœã€‚

### èˆ‡ MajsoulMax è¯å‹•

MajsoulMax æ˜¯ç”¨æ–¼è§£é–é›€é­‚å¤–è§€çš„å°ˆæ¡ˆï¼ŒåŸç†èˆ‡ Akagi é¡ä¼¼ï¼Œéƒ½æ˜¯é€é MITM ä»£ç†æ””æˆªéŠæˆ²æµé‡å¾Œè™•ç†ã€‚å› å…©è€…éƒ½éœ€è¦ MitMï¼Œéœ€è¦é…ç½®ä»£ç†éˆè®“æµé‡ä¸²è¡Œç¶“éå…©å€‹ç¯€é»ï¼Œä¸¦åŒæ™‚ä¿¡ä»»å…©ä»½æ†‘è­‰ï¼Œå°¤å…¶è¦é¿å…å›ç’°ä»£ç†ã€‚

MajsoulMax æœ‰å…©å€‹ç‰ˆæœ¬ï¼š[Python](https://github.com/Avenshy/MajsoulMax) èˆ‡ [Rust](https://github.com/Xerxes-2/MajsoulMax-rs)ã€‚

å°æ‡‰åœ°ï¼Œé€™è£¡ä¹Ÿæä¾›åŸºæ–¼ MajsoulMax-rs å’ŒåŸºæ–¼ MajsoulMax çš„å…©ç¨®è¨­å®šï¼Œå·®ç•°åœ¨æ–¼ï¼š

1. MajsoulMax-rsï¼ˆRustï¼‰å•Ÿå‹•çš„æ˜¯ HTTP ä»£ç†ï¼ˆåŸºæ–¼ hudsuckerï¼‰ï¼Œéˆå¼ä»£ç†åˆå§‹åŒ–å¯èƒ½æœƒé‡åˆ°å•é¡Œï¼Œä½†åˆ†æµç°¡å–®ã€ä½¿ç”¨æ–¹ä¾¿ã€ç„¡éœ€è™•ç†ç’°å¢ƒä¾è³´ã€‚
2. MajsoulMaxï¼ˆPythonï¼‰å•Ÿå‹•çš„æ˜¯ HTTPS ä»£ç†ï¼ˆåŸºæ–¼ mitmproxyï¼‰ï¼Œå¯ä»¥å®Œç¾é€²è¡Œéˆå¼ä»£ç†ã€‚

#### Rust ç‰ˆæœ¬è¨­å®š

Rust ç‰ˆæœ¬ä»£ç†éˆå¦‚ä¸‹ï¼š

```
Game <-> majsoul_max_rs(23410, http) <-> akagi(7880, https) <-> Server
```

åˆ†æµå®Œå…¨ä¾è³´ä½ çš„ä»£ç†è»Ÿé«”ï¼Œç¤ºä¾‹è¨­å®šå¦‚ä¸‹ï¼š

Clashï¼š

```yaml
proxies:
    - name: MajsoulMax
      port: 23410
      server: 127.0.0.1
      tls: false
      type: http
    - name: Akagi
      port: 7880
      server: 127.0.0.1
      tls: true
      type: http
proxy-groups:
    - name: ğŸ€„ é›€é­‚éº»å°‡
      proxies:
          - MajsoulMax
          - DIRECT
      type: select
rules:
    # é¿å… Akagi å›ç’°ä»£ç†
    - AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
    # å¼·åˆ¶å°‡ majsoul_max_rs çš„æµé‡å°å‘ akagi
    - PROCESS-NAME-REGEX,majsoul_max_rs.*?,Akagi
    # å°‡é›€é­‚éŠæˆ²æµé‡åˆ†æµ
    # å®¢æˆ¶ç«¯ / Steam
    - PROCESS-NAME,Jantama_MahjongSoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,jantama_mahjongsoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
    # ç¶²é ç«¯
    - DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

Surgeï¼š

```text
[Proxy]
MajsoulMax = http, 127.0.0.1, 23410
Akagi = http, 127.0.0.1, 7880

[Proxy Group]
ğŸ€„ é›€é­‚éº»å°‡ = select, MajsoulMax, DIRECT

[Rule]
AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
PROCESS-NAME,majsoul_max_rs,Akagi
# å®¢æˆ¶ç«¯ / Steam
PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
# ç¶²é ç‰ˆ
DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

#### Python ç‰ˆæœ¬è¨­å®š

Python ç‰ˆæœ¬ä»£ç†éˆå¦‚ä¸‹ï¼š

```
Game <-> MajsoulMax(23410, https) <-> akagi(7880, https) <-> Server
```

æ³¨æ„ï¼ŒMajsoulMaxï¼ˆPythonï¼‰èˆ‡ Akagi åœ¨ `protobuf` ç‰ˆæœ¬è¦æ±‚ä¸Šä¸åŒï¼Œå¿…é ˆä½¿ç”¨å…©å€‹ç¨ç«‹ç’°å¢ƒæˆ–ä½¿ç”¨ Vendor æ§åˆ¶è©²ä¾è³´ã€‚

> æˆ–è€…ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ [MajsoulHelper](https://github.com/zhuozhiyongde/MajsoulHelper) ä»¥å®¹å™¨åŒ–æ–¹å¼åŒæ™‚å•Ÿå‹•å…©è€…ã€‚

æ­¤æ™‚éœ€æŒ‡å®š upstream ç‚º Akagi çš„é€£æ¥åŸ ä¸¦å…è¨±ä¸å®‰å…¨é€£ç·šä¾†å•Ÿå‹• MajsoulMaxï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°ä»£ç†éˆä¸­çš„ç¬¬äºŒå€‹ `<->` éœ€é€éä»£ç†è»Ÿé«”ä¹‹å¤–çš„æ–¹å¼å®Œæˆï¼š

```shell
mitmdump -p 23410 --mode upstream:http://127.0.0.1:7880 -s addons.py --ssl-insecure
```

ç¤ºä¾‹è¨­å®šå¦‚ä¸‹ï¼š

Clashï¼š

```yaml
proxies:
    - name: MajsoulMax
      port: 23410
      server: 127.0.0.1
      tls: true
      type: http
proxy-groups:
    - name: ğŸ€„ é›€é­‚éº»å°‡
      proxies:
          - MajsoulMax
          - DIRECT
      type: select
rules:
    # é¿å… Akagiã€MajsoulMax å›ç’°ä»£ç†
    - AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
    # å°‡é›€é­‚éŠæˆ²æµé‡åˆ†æµ
    # å®¢æˆ¶ç«¯ / Steam
    - PROCESS-NAME,Jantama_MahjongSoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,jantama_mahjongsoul.exe,ğŸ€„ é›€é­‚éº»å°‡
    - PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
    # ç¶²é ç«¯
    - DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
    - DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

Surgeï¼š

```text
[Proxy]
MajsoulMax = https, 127.0.0.1, 23410

[Proxy Group]
ğŸ€„ é›€é­‚éº»å°‡ = select, MajsoulMax, DIRECT

[Rule]
AND, ((PROCESS-NAME-REGEX, python.*?), (OR, ((DOMAIN-KEYWORD, majsoul), (DOMAIN-KEYWORD, maj-soul), (DOMAIN-KEYWORD, mahjongsoul), (DOMAIN-KEYWORD, catmjstudio)))), DIRECT
# å®¢æˆ¶ç«¯ / Steam
PROCESS-NAME,é›€é­‚éº»å°‡,ğŸ€„ é›€é­‚éº»å°‡
# ç¶²é ç‰ˆ
DOMAIN-KEYWORD,majsoul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,maj-soul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,mahjongsoul,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,catmjstudio,ğŸ€„ é›€é­‚éº»å°‡
DOMAIN-KEYWORD,catmajsoul,ğŸ€„ é›€é­‚éº»å°‡
```

## æ“ä½œæ¼”ç¤º

### å•Ÿå‹• MitM ä»£ç†ä¼ºæœå™¨

![image](./docs/gifs/start_mitm.gif)

### é¸æ“‡ AI æ¨¡å‹

æ¨¡å‹å„²å­˜åœ¨ `./mjai_bot/` è³‡æ–™å¤¾

![image](./docs/gifs/select_model.gif)

### è®Šæ›´è¨­å®š

> [!IMPORTANT]
>
> é‡æ–°å•Ÿå‹•å¾Œè¨­å®šæ‰æœƒè¢«å¥—ç”¨

![image](./docs/gifs/settings.gif)

### é–‹å•Ÿæ—¥èªŒ

å‡ºç¾å•é¡Œæ™‚å¯é–‹å•Ÿæ—¥èªŒä»¥äº†è§£ç‹€æ³ï¼Œä¸¦åŒæ™‚å‘é–‹ç™¼è€…å›å ±ã€‚

å„²å­˜è·¯å¾‘ï¼š`./logs/`

![image](./docs/gifs/logs_screen.gif)

### åˆ‡æ› MJAI è¦–çª—

é»é¸è©²è¦–çª—å³å¯åˆ‡æ›

![image](./docs/gifs/change_window.gif)

### AutoPlay

> [!NOTE]
>
> AutoPlay åªåœ¨ Windows Release ç‰ˆå•Ÿç”¨ï¼Œä¸”å¿…é ˆå•Ÿå‹• ot_serverã€‚

ç¢ºä¿éŠæˆ²å®¢æˆ¶ç«¯çš„é¡¯ç¤ºæ¯”ä¾‹è¨­å®šç‚º 16:9

![image](./docs/images/autoplay_example/good.png)

![image](./docs/images/autoplay_example/bad_1.png)

![image](./docs/images/autoplay_example/bad_2.png)

### æ›´æ›ä¸»é¡Œ

![image](./docs/gifs/change_theme.gif)

### ç«‹ç›´å®£å‘Š

å›  MJAI å”è­°é™åˆ¶ï¼Œå»ºè­°æ¬„ç‚ºç«‹ç›´æ™‚ä¸æœƒé¡¯ç¤ºæ£„ç‰Œã€‚

ä½ å¿…é ˆæ‰‹å‹•é»æ“Šç«‹ç›´æŒ‰éˆ•ä¾†å®£å‘Šç«‹ç›´ã€‚

![image](./docs/gifs/call_reach.gif)

## å¸¸è¦‹å•é¡Œ

å¯è‡³ [Discord](https://discord.gg/Z2wjXUK8bN) æˆ– Issue é é¢è©¢å•å•é¡Œã€‚

> [!TIP]
>
> è‹¥æœ‰ä»»ä½•å•é¡Œï¼Œè«‹é™„ä¸Šæ—¥èªŒæª”æ¡ˆï¼Œé€™æ¨£æˆ‘æ‰èƒ½æ›´å¿«å”åŠ©ä½ ã€‚
>
> æ—¥èªŒæª”ä½æ–¼ `./logs/` è³‡æ–™å¤¾ã€‚

### MitM Proxy ç„¡æ³•å•Ÿå‹•

-   ç¢ºèªæ˜¯å¦æœ‰å…¶ä»–æ‡‰ç”¨å ç”¨é€£æ¥åŸ 
-   ç¢ºèªæ˜¯å¦å·²å®‰è£ä¸¦ä¿¡ä»» MitM Proxy æ†‘è­‰
-   ç¢ºèªè¨­å®šçš„ Host èˆ‡ Port æ˜¯å¦æ­£ç¢º
-   ç¢ºèªæ˜¯å¦æœ‰é˜²ç«ç‰†é˜»æ“‹ MitM Proxy
-   ç¢ºèª MitM Proxy Server æ˜¯å¦å·²å•Ÿå‹•
-   è‹¥ä»ç„¡æ³•å•Ÿå‹•ï¼Œè«‹åƒè€ƒ [é€™å€‹ Issue](https://github.com/shinkuan/Akagi/issues/57)

## é–‹ç™¼

### å°ˆæ¡ˆçµæ§‹

```shell
.
â”œâ”€â”€ akagi # Akagi çš„ Textual UI
â”œâ”€â”€ autoplay # AutoPlay çš„å¯¦ä½œ
â”œâ”€â”€ dataserver # DataServer çš„å¯¦ä½œ
â”œâ”€â”€ logs # æ—¥èªŒå„²å­˜ç›®éŒ„
â”œâ”€â”€ mitm # MitM ä»£ç†ä¼ºæœå™¨
â”‚   â”œâ”€â”€ bridge # éŠæˆ²å®¢æˆ¶ç«¯èˆ‡ä¼ºæœå™¨çš„æ©‹æ¥å™¨ï¼Œç”¨ä¾†è½‰æ›ç‚º MJAI å”è­°
â”‚   â”‚   â”œâ”€â”€ amatsuki # å¤©æœˆæ©‹æ¥å™¨
â”‚   â”‚   â”œâ”€â”€ majsoul # é›€é­‚æ©‹æ¥å™¨
â”‚   â”‚   â”œâ”€â”€ riichi_city # ä¸€ç•ªè¡—æ©‹æ¥å™¨
â”‚   â”‚   â”œâ”€â”€ tenhou # å¤©é³³æ©‹æ¥å™¨
â”‚   â”‚   â””â”€â”€ unified # çµ±ä¸€æ©‹æ¥å™¨
â”œâ”€â”€ mjai_bot # MJAI æ©Ÿå™¨äºº
â”‚   â”œâ”€â”€ base # æ©Ÿå™¨äººåŸºç¤é¡åˆ¥ï¼Œå¯åƒè€ƒè‡ªè£½æ©Ÿå™¨äºº
â”‚   â”œâ”€â”€ mortal # é è¨­çš„å››äººéº»å°‡æ¨¡å‹
â”‚   â””â”€â”€ mortal3p # é è¨­çš„ä¸‰äººéº»å°‡æ¨¡å‹
â”œâ”€â”€ settings # è¨­å®šè³‡æ–™å¤¾
â””â”€â”€ run_akagi.py # å•Ÿå‹•ç¨‹å¼
```

### æ©‹æ¥å™¨

è¦è£½ä½œæ©‹æ¥å™¨ï¼Œéœ€è¦å¯¦ä½œå…©éƒ¨åˆ†ï¼š

1. `mitm/bridge/mitm_abc.py` ä¸­çš„ `ClientWebSocketABC`
2. `mitm/bridge/bridge_base.py` ä¸­çš„ `Bridge`

ClientWebSocketABC æ˜¯ mitmproxy çš„ addonï¼ŒåŠŸèƒ½æ˜¯å°‡éŠæˆ²å”è­°è½‰ç‚º MJAI å”è­°ä¸¦æ¨å…¥ `mjai_messages: queue.Queue[dict] = queue.Queue()`ã€‚å¯åƒè€ƒ `mitm/majsoul/`ã€‚

Bridge ç‚ºæ©‹æ¥ä¸»é¡åˆ¥ï¼Œä½ éœ€è¦å¯¦ä½œ `parse()` æ–¹æ³•ï¼Œå°‡éŠæˆ²æ”¶åˆ°çš„è³‡æ–™è§£æç‚º `None | list[dict]`ï¼Œå¯åƒè€ƒ `mitm/bridge/amatsuki/bridge.py`ã€‚

### MJAI æ©Ÿå™¨äºº

è¦è£½ä½œ MJAI æ©Ÿå™¨äººï¼Œéœ€è¦å¯¦ä½œ `mjai_bot/base/bot.py` ä¸­çš„ `Bot` é¡åˆ¥ã€‚

> TODO: è£½ä½œä¸€å€‹ tsumogiri bot ç¯„ä¾‹

## TODO

-   [x] æ”¯æ´ä¸‰äººéº»å°‡
-   [x] æ”¯æ´ RiichiCity
-   [x] ç«‹ç›´å¾Œæ¨è–¦åˆ‡ç‰Œ
-   [ ] æ§“å¾Œæ¨è–¦åˆ‡ç‰Œï¼ˆæ¥µå°‘è¦‹ï¼‰

## ä½œè€…

-   [Shinkuan](https://github.com/shinkuan/) - shinkuan318@gmail.com
-   [Discord](https://discord.gg/Z2wjXUK8bN)

## æˆæ¬Šæ¢æ¬¾

```
â€œCommons Clauseâ€ License Condition v1.0

The Software is provided to you by the Licensor under the License, as defined below, subject to the following condition.

Without limiting other conditions in the License, the grant of rights under the License will not include, and the License does not grant to you, the right to Sell the Software.

For purposes of the foregoing, â€œSellâ€ means practicing any or all of the rights granted to you under the License to provide to third parties, for a fee or other consideration (including without limitation fees for hosting or consulting/ support services related to the Software), a product or service whose value derives, entirely or substantially, from the functionality of the Software. Any license notice or attribution required by the License must also include this Commons Clause License Condition notice.

Software: Akagi

License: GNU Affero General Public License version 3 with Commons Clause

Licensor: shinkuan
```
